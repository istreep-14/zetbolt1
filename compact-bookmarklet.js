javascript:(function(){if(window.zt){window.zt.toggle();return;}const t={on:0,g:null,gs:JSON.parse(localStorage.zetamac||'[]'),ui:null,init(){this.createUI();this.watch();},createUI(){let e=document.getElementById('zt');if(e)e.remove();this.ui=document.createElement('div');this.ui.id='zt';this.ui.innerHTML=`<div style="position:fixed;top:10px;right:10px;z-index:9999;background:#4f46e5;color:#fff;padding:10px;border-radius:8px;font:12px sans-serif;box-shadow:0 4px 12px rgba(0,0,0,0.3);min-width:200px"><h4 style="margin:0 0 8px 0">Zetamac ${this.on?'ON':'OFF'}</h4><div style="font-size:11px;margin-bottom:8px">Games: ${this.gs.length} | Qs: ${this.total()}</div><button id="zt-tog" style="padding:6px 12px;border:none;border-radius:4px;background:${this.on?'#ef4444':'#10b981'};color:#fff;cursor:pointer;margin-right:4px">${this.on?'Stop':'Start'}</button><button id="zt-csv" style="padding:6px 8px;border:none;border-radius:4px;background:#6b7280;color:#fff;cursor:pointer;margin-right:4px">CSV</button><button id="zt-clr" style="padding:6px 8px;border:none;border-radius:4px;background:#ef4444;color:#fff;cursor:pointer">Clear</button>${this.g?`<div style="margin-top:8px;font-size:11px;background:rgba(255,255,255,0.1);padding:6px;border-radius:4px">Current: ${this.g.qs.length} questions</div>`:''}</div>`;document.body.appendChild(this.ui);document.getElementById('zt-tog').onclick=()=>this.toggle();document.getElementById('zt-csv').onclick=()=>this.csv();document.getElementById('zt-clr').onclick=()=>this.clear();},watch(){new MutationObserver(()=>{if(!this.on)return;if(location.href.includes('/game?key=')&&!this.g){this.g={id:Date.now(),start:Date.now(),qs:[],score:0,url:location.href};this.update();}this.checkQ();this.checkS();}).observe(document.body,{childList:1,subtree:1});},checkQ(){if(!this.g)return;document.querySelectorAll('span,div,p').forEach(e=>{let txt=e.textContent.trim();if(txt.match(/^\d+[\+\-\ร\*\/รท]\d+$/)&&!e.dataset.t){e.dataset.t='1';this.g.qs.push({q:txt,start:Date.now(),end:0,ans:'',time:0});this.update();}});document.querySelectorAll('input').forEach(i=>{if(!i.dataset.t){i.addEventListener('keydown',e=>{if(e.key==='Enter'&&this.g&&this.g.qs.length){let q=this.g.qs[this.g.qs.length-1];if(!q.end){q.end=Date.now();q.ans=i.value;q.time=(q.end-q.start)/1000;this.update();}}});i.dataset.t='1';}});},checkS(){if(!this.g)return;document.querySelectorAll('*').forEach(e=>{let txt=e.textContent;if(txt.includes('Score')&&txt.match(/\d+/)){let m=txt.match(/(\d+)/);if(m&&!this.g.score){this.g.score=parseInt(m[1]);if(this.g.score>0){this.gs.push(this.g);localStorage.zetamac=JSON.stringify(this.gs);this.g=null;this.update();}}}});},toggle(){this.on=!this.on;this.update();},clear(){if(confirm('Clear all data?')){this.gs=[];this.g=null;localStorage.removeItem('zetamac');this.update();}},csv(){let c='Game,Start,Score,Question,Answer,Time\n';this.gs.forEach(g=>{g.qs.forEach(q=>{c+=`${g.id},${new Date(g.start).toISOString()},${g.score},"${q.q}","${q.ans}",${q.time}\n`;});});let b=new Blob([c],{type:'text/csv'});let u=URL.createObjectURL(b);let a=document.createElement('a');a.href=u;a.download='zetamac.csv';a.click();},total(){return this.gs.reduce((a,g)=>a+g.qs.length,0)+(this.g?this.g.qs.length:0);},update(){if(this.ui){this.createUI();}}};t.init();window.zt=t;})();